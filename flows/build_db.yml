id: create_db
namespace: shopzada.flows

tasks:
  - id: dbt_build
    type: io.kestra.plugin.dbt.cli.DbtCLI
    workingDirectory: /WorkingDirectory
    taskRunner:
      type: io.kestra.plugin.scripts.runner.docker.Docker
    containerImage: ghcr.io/kestra-io/dbt-duckdb:latest
    commands:
      - dbt deps
      - dbt build
    profiles: |
      ShopZada:
        outputs:
          dev:
            type: duckdb
            path: dbt.duckdb
            extensions:
              - parquet
            fixed_retries: 1
            threads: 16
            timeout_seconds: 300
        target: dev
